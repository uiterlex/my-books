<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Book Collection</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 2rem;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        header {
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2rem;
            font-weight: 600;
            color: #1a1a1a;
        }

        .stats {
            color: #666;
            margin-top: 0.5rem;
        }

        .book-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .book-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .book-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 0.25rem;
        }

        .book-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1a1a1a;
        }

        .category {
            background: #fef3c7;
            color: #92400e;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            white-space: nowrap;
            text-transform: capitalize;
        }

        .category.thriller { background: #fee2e2; color: #991b1b; }
        .category.detective { background: #dbeafe; color: #1e40af; }
        .category.other { background: #e5e7eb; color: #374151; }

        .book-author {
            color: #666;
            margin-bottom: 0.75rem;
        }

        .book-meta {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }

        .book-meta span {
            display: flex;
            align-items: center;
            gap: 0.35rem;
            color: #555;
        }

        .stars {
            color: #f59e0b;
            letter-spacing: 1px;
        }

        .series {
            background: #e0e7ff;
            color: #3730a3;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .book-details {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 0.75rem;
            padding-top: 0.5rem;
            border-top: 1px solid #eee;
        }

        .book-details span {
            display: flex;
            align-items: center;
            gap: 0.35rem;
        }

        .text-preview {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #eee;
        }

        .text-preview-row {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .text-preview-row:last-child {
            margin-bottom: 0;
        }

        .preview-label {
            font-weight: 500;
            color: #555;
            min-width: 60px;
        }

        .preview-text {
            color: #666;
            flex: 1;
        }

        .truncated {
            display: inline;
        }

        .expand-btn {
            background: none;
            border: none;
            color: #6366f1;
            cursor: pointer;
            padding: 0.1rem 0.3rem;
            font-size: 0.85rem;
            border-radius: 3px;
            transition: background 0.2s;
        }

        .expand-btn:hover {
            background: #eef2ff;
        }

        /* Modal styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 12px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            border-bottom: 1px solid #eee;
        }

        .modal-title {
            font-weight: 600;
            color: #1a1a1a;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }

        .modal-close:hover {
            color: #333;
        }

        .modal-body {
            padding: 1.25rem;
            color: #444;
            line-height: 1.7;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö My Book Collection</h1>
            <p class="stats" id="stats">Loading...</p>
        </header>

        <div class="book-list" id="book-list">
            <div class="loading">Loading books...</div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modal" onclick="closeModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span class="modal-title" id="modal-title">Title</span>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                Content
            </div>
        </div>
    </div>

    <script>
        // Book data - ready for Firebase integration
        const books = [
            {
                id: 1,
                title: "De puzzelaar",
                author: "Marit Vanstr√∂m",
                pages: 315,
                rating: 5,
                series: "Lianne Bloemen serie",
                category: "thriller",
                dateRead: "2024-12",
                firstEdition: "2023",
                preview: "Een gruwelijke ontdekking in een verlaten pand zet rechercheur Lianne Bloemen op het spoor van een sadistische moordenaar die puzzels achterlaat bij zijn slachtoffers.",
                plot: "Rechercheur Lianne Bloemen wordt geconfronteerd met een serie bizarre moorden waarbij de dader steeds een puzzel achterlaat. Terwijl ze de aanwijzingen probeert te ontcijferen, ontdekt ze een patroon dat haar dichter bij de moordenaar brengt - maar ook dichter bij haar eigen verleden."
            },
            {
                id: 2,
                title: "De jager en de prooi",
                author: "Marit Vanstr√∂m",
                pages: 275,
                rating: 4,
                series: "Lianne Bloemen serie",
                category: "thriller",
                dateRead: "2024-11",
                firstEdition: "2022",
                preview: "Een klopjacht door de bossen van de Veluwe als een gevaarlijke crimineel ontsnapt en zweert wraak te nemen op degenen die hem hebben opgesloten.",
                plot: "Na een gewaagde ontsnapping uit de gevangenis begint een veroordeelde moordenaar aan een wraaktocht. Lianne Bloemen moet hem zien te stoppen voordat hij zijn doelwitten bereikt, maar al snel blijkt dat de rollen kunnen omdraaien."
            },
            {
                id: 3,
                title: "De 20",
                author: "Sam Holland",
                pages: 384,
                rating: 5,
                series: "Adam Bishop serie",
                category: "detective",
                dateRead: "2024-10",
                firstEdition: "2021",
                preview: "Twintig mensen worden vermist in √©√©n nacht. Rechercheur Adam Bishop staat voor de grootste zaak uit zijn carri√®re.",
                plot: "Op √©√©n nacht verdwijnen twintig mensen spoorloos uit een klein dorp. Rechercheur Adam Bishop ontdekt dat de verdwijningen verband houden met een geheim dat al decennia verborgen werd gehouden door de dorpsbewoners."
            },
            {
                id: 4,
                title: "Het Bernini mysterie",
                author: "Dan Brown",
                pages: 480,
                rating: 4,
                series: "Robert Langdon serie",
                category: "thriller",
                dateRead: "2024-09",
                firstEdition: "2000",
                preview: "Een oude vijand van het Vaticaan duikt weer op en dreigt vier kardinalen te vermoorden tijdens de pauskeuze.",
                plot: "Professor Robert Langdon wordt naar Rome geroepen wanneer de Illuminati dreigen vier kardinalen te vermoorden en het Vaticaan te vernietigen met een gestolen antimaterie-bom. Hij moet de aanwijzingen van de oude geheime broederschap volgen door de kunstwerken van Bernini."
            }
        ];

        // Render functions
        function renderStars(rating) {
            return '‚òÖ'.repeat(rating) + '‚òÜ'.repeat(5 - rating);
        }

        function formatDate(dateStr) {
            const [year, month] = dateStr.split('-');
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return `${monthNames[parseInt(month) - 1]} ${year}`;
        }

        function truncateText(text, maxLength = 50) {
            if (text.length <= maxLength) return text;
            return text.substring(0, maxLength).trim() + '...';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function renderBook(book) {
            return `
                <article class="book-card" data-book-id="${book.id}">
                    <div class="book-header">
                        <h2 class="book-title">${escapeHtml(book.title)}</h2>
                        <span class="category ${book.category}">${escapeHtml(book.category)}</span>
                    </div>
                    <p class="book-author">${escapeHtml(book.author)}</p>
                    <div class="book-meta">
                        <span class="stars">${renderStars(book.rating)}</span>
                        <span>üìÑ ${book.pages} pages</span>
                        ${book.series ? `<span class="series">${escapeHtml(book.series)}</span>` : ''}
                    </div>
                    <div class="book-details">
                        <span>üìÖ Read: ${formatDate(book.dateRead)}</span>
                        <span>üìñ First edition: ${escapeHtml(book.firstEdition)}</span>
                    </div>
                    ${book.preview || book.plot ? `
                        <div class="text-preview">
                            ${book.preview ? `
                                <div class="text-preview-row">
                                    <span class="preview-label">Preview:</span>
                                    <span class="preview-text">
                                        <span class="truncated">${escapeHtml(truncateText(book.preview))}</span>
                                        <button class="expand-btn" data-title="Preview: ${escapeHtml(book.title)}" data-content="${escapeHtml(book.preview)}">‚ÑπÔ∏è</button>
                                    </span>
                                </div>
                            ` : ''}
                            ${book.plot ? `
                                <div class="text-preview-row">
                                    <span class="preview-label">Plot:</span>
                                    <span class="preview-text">
                                        <span class="truncated">${escapeHtml(truncateText(book.plot))}</span>
                                        <button class="expand-btn" data-title="Plot: ${escapeHtml(book.title)}" data-content="${escapeHtml(book.plot)}">‚ÑπÔ∏è</button>
                                    </span>
                                </div>
                            ` : ''}
                        </div>
                    ` : ''}
                </article>
            `;
        }

        function renderStats(books) {
            const totalBooks = books.length;
            const totalPages = books.reduce((sum, book) => sum + book.pages, 0);
            return `${totalBooks} books read ¬∑ ${totalPages.toLocaleString()} pages`;
        }

        function renderBooks(books) {
            const bookList = document.getElementById('book-list');
            const stats = document.getElementById('stats');
            
            if (books.length === 0) {
                bookList.innerHTML = '<div class="loading">No books in collection yet.</div>';
                stats.textContent = '0 books read';
                return;
            }

            // Sort by date read (newest first)
            const sortedBooks = [...books].sort((a, b) => b.dateRead.localeCompare(a.dateRead));
            
            bookList.innerHTML = sortedBooks.map(renderBook).join('');
            stats.textContent = renderStats(books);

            // Add event listeners to expand buttons
            document.querySelectorAll('.expand-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    showModal(btn.dataset.title, btn.dataset.content);
                });
            });
        }

        // Modal functions
        function showModal(title, content) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-body').textContent = content;
            document.getElementById('modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(event) {
            if (!event || event.target === document.getElementById('modal')) {
                document.getElementById('modal').classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderBooks(books);
        });
    </script>
</body>
</html>
